extends layout

append head
    link(rel='stylesheet', href='/billnit88a/moderator.css')

include bbCodes.pug

block content
    nav.mod-nav
        a#mon-posts-but(href="/sp4m-ch8ck") posts
        | 
        a#mod-comments-but(href="/sp4m-ch8ck?what=comments") comments

    if posts.length
        .mod-posts

            each post in posts
                -
                    let conClasses = []
                    const canDelete = user.is_super_admin

                    if(canDelete && post.is_removed) {
                        conClasses.push('removed-row')
                    }

                    conClasses.push(post.is_user_post_spam
                        ? 'spam-row' : 'not-spam-row')

                div(class=conClasses)
                    if post.link === null
                        a(href=`/p/${post.public_id}`)= post.title
                    else
                        a(href=post.link)= post.title

                    div.mod-post-header
                        | by #{post.username}
                        | on #{post.created_on}
                        | 
                        || 

                        a(href=`/p/${post.public_id}`) comments(#{post.num_comments})

                        | 
                        if canDelete
                            span(class="spam-count") +#{post.num_spam_votes}

                            if !post.is_removed
                                | 
                                form(method="post" action=`/sp4m-ch8ck?p=${page}&before=${before}`)
                                    input(type="submit" value="Remove")
                                    input(type="hidden" name="remove_post_id" value=post.public_id)

                        if !post.is_user_post_spam
                            form(method="post" action=`/sp4m-ch8ck?p=${page}&before=${before}`)
                                input(type="submit" value="Flag")
                                input(type="hidden" name="spam_post_id" value=post.public_id)

                    if post.text_content !== null
                        div.m9-post
                            +bbCodes(post.text_content)

        div
            a(href=`/sp4m-ch8ck?p=${page + 1}&before=${before}`) more
    else
        span no posts
